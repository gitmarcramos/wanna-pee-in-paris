var G=Object.defineProperty,L=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var I=(r,s,i)=>s in r?G(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,x=(r,s)=>{for(var i in s||(s={}))D.call(s,i)&&I(r,i,s[i]);if(S)for(var i of S(s))T.call(s,i)&&I(r,i,s[i]);return r},P=(r,s)=>L(r,O(s));import{j as E,r as l,v as j,M as q,S as W,L as F,G as H,a as $,R as B,b as V}from"./vendor.e409fc1c.js";const z=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function i(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerpolicy&&(c.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?c.credentials="include":a.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(a){if(a.ep)return;a.ep=!0;const c=i(a);fetch(a.href,c)}};z();const e=E.exports.jsx,t=E.exports.jsxs,f=E.exports.Fragment;function R(r){return e("span",{className:"error-message body-min",children:r.msg})}function J(r){const[s,i]=l.exports.useState(""),n=p=>{i(p.currentTarget.value)},[a,c]=l.exports.useState(null),d=["75001","75002","75003","75004","75005","75006","75007","75008","75009","75010","75011","75012","75013","75014","75015","75016","75017","75018","75019","75020"],m=()=>{d.includes(s)&&(c(s),i(""))},[o,u]=l.exports.useState({latitude:null,longitude:null}),[b,v]=l.exports.useState(!1),N=async()=>{navigator.geolocation.getCurrentPosition(function(p){u({latitude:p.coords.latitude,longitude:p.coords.longitude})},function(p){p.code==p.PERMISSION_DENIED&&v(!0)})};l.exports.useEffect(()=>{r.getArr(a),r.getGeolocate(o)},[a,o]);const[g,y]=l.exports.useState(!1),h=()=>{(isNaN(s)||s.length!==5||!d.includes(s))&&y(!0)};return t("div",{className:"main-search container",children:[e("h1",{className:"body",children:"Dans quel arrondissement de Paris cherchez-vous des toilettes publiques?"}),t("div",{className:"search-options",children:[t("div",{className:"search-bar",children:[e("input",{type:"text",pattern:"[0-9]*",className:"search-input",onInput:n,value:s}),e("button",{className:"button button--search",onClick:()=>{m(),h(),i("")},children:"Go !"})]}),g&&e(R,{msg:"Veuillez entrer un arrondissement de Paris entre 75001 et 75020"}),e("span",{className:"body-min",children:"ou"}),e("button",{className:"button button--main",onClick:N,children:"G\xE9olocalisez-moi !"}),b?e(R,{msg:"La geolocalisation n'est pas activ\xE9e sur votre navigateur"}):null]})]})}var Y="/assets/Close.9d59c4e7.svg";var w="/assets/clock.64606870.svg",A="/assets/wheel.3d4ab1d9.svg",M="/assets/baby.9224b752.svg";function C(r){const s=r.data,i=r.data.fields.horaire||"non sp\xE9cifi\xE9",[n,a]=l.exports.useState({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()});l.exports.useEffect(()=>{a({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()})},[s]);let d=(()=>{let m=[];if(n.closing-n.opening>0)for(let o=n.opening;o<=n.closing;o++)m.push(o);if(n.closing-n.opening==0)for(let o=0;o<=24;o++)m.push(o);if(n.closing-n.opening<0){for(let o=n.opening;o<=24;o++)m.push(o);for(let o=0;o<=n.closing;o++)m.push(o)}if(!isNaN(n.opening)){if(m.includes(n.userHour))return!0;if(!m.includes(n.userHour))return!1}})();return t("div",{className:"item-result",children:[t("div",{className:"item-head",children:[t("h2",{className:"body-min",children:["Type : ",s.fields.type]}),t("h4",{className:"title",children:[s.fields.adresse," - ",s.fields.arrondissement]}),t("div",{className:"item-openState",children:[e("div",{className:d===!0?"state-indicator open":d===!1?"state-indicator closed":"state-indicator maybe"}),e("p",{className:"sub",children:d===!0?"Ouvertes en ce moment":d===!1?"Ferm\xE9es en ce moment":"Horaires d'ouvertures indisponibles."})]})]}),t("div",{className:"item-result-infos",children:[s.fields.horaire==="Voir fiche \xE9quipement"?t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires"}),e("a",{href:s.fields.url_fiche_equipement,className:"body-min",target:"_blank",children:"Voir les horaires"})]}):e(f,{children:s.fields.horaire?t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires"}),e("h5",{className:"body-min",children:s.fields.horaire})]}):t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires",className:"disabled"}),e("h5",{className:"body-min",children:"Non sp\xE9cifi\xE9"})]})}),s.fields.acces_pmr==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:A,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:A,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}),s.fields.relais_bebe&&s.fields.relais_bebe==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:M,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:M,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]})]})]})}function _(r){const[s,i]=l.exports.useState(!0);return l.exports.useEffect(()=>{const n=setTimeout(()=>{i(!1)},800);return()=>{clearTimeout(n)}},[]),e(f,{children:s&&t("div",{className:"loader",children:[e("h1",{className:"body white",children:"Recherche en cours"}),t("svg",{width:"58",height:"58",viewBox:"0 0 58 58",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("circle",{id:"loader-out",cx:"29",cy:"29",r:"28",stroke:"white",strokeWidth:"2",strokeDasharray:"170"}),e("circle",{id:"loader-middle",cx:"29",cy:"29",r:"21",stroke:"white",strokeWidth:"2",strokeDasharray:"150"}),e("circle",{id:"loader-in",cx:"29",cy:"29",r:"13",stroke:"white",strokeWidth:"2",strokeDasharray:"50"})]})]})})}function U(r){const[s,i]=l.exports.useState([]);l.exports.useState({longitude:"",latitude:""});const[n,a]=l.exports.useState(""),c=u=>{u.currentTarget.checked?a("&refine.acces_pmr=Oui"):a("")},[d,m]=l.exports.useState(""),o=u=>{u.currentTarget.checked?m("&refine.relais_bebe=Oui"):m("")};return l.exports.useEffect(async()=>{try{const u=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=100&q=&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe&refine.arrondissement="+r.data+n+d+"")).json();i(u.records)}catch(u){console.error(u)}},[n,d]),t(f,{children:[e(_,{}),t("div",{className:"search-results container",children:[t("div",{className:"search-results__data",children:[e("img",{src:Y,alt:"Close button",className:"close-svg",onClick:r.reset}),t("div",{className:"search-results__data--main",children:[t("h1",{className:"title",children:["Toilettes publiques dans le ",r.data]}),t("h2",{children:[s.length," r\xE9sultats"]})]}),t("div",{className:"search-results__data--filter",children:[e("h3",{className:"sub",children:"Filtrer"}),t("div",{className:"filter-input",children:[t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"acces-pmr",className:"body-min",children:"Acc\xE8s PMR"}),e("input",{type:"checkbox",id:"acces-pmr",onChange:c})]}),t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"relais-bebe",className:"body-min",children:"Relais b\xE9b\xE9"}),e("input",{type:"checkbox",id:"relais-bebe",onChange:o})]})]})]}),e("button",{className:"button-link body",onClick:r.reset,children:"Nouvelle recherche"})]}),s.length===0?e("p",{className:"body",children:"Aucun r\xE9sultat"}):e("div",{className:"toilet",children:s.map(u=>e(C,{data:u},j()))})]})]})}function K(){return t("div",{className:"page-menu",children:[t("div",{className:"about",children:[e("h2",{className:"title white",children:"\xC0 Propos"}),e("p",{className:"body white",children:"Wanna Pee in Paris a pour objectif de vous aider \xE0 trouver rapidement des toilettes publiques dans l\u2019arrondissement Parisien que vous renseignez."})]}),t("div",{className:"credits",children:[e("h3",{className:"body white",children:"Cr\xE9dits"}),t("span",{className:"body-min white",children:["Design et d\xE9veloppement web :"," ",e("a",{className:"white",href:"https://www.marcramos.fr/",target:"_blank",children:"Marc Ramos"})," "]}),e("br",{}),t("span",{className:"body-min white",children:["Image d'illustration :"," ",e("a",{className:"white",href:"https://www.pablostanley.com/",target:"_blank",children:"Pablo Stanley"})," "]}),e("br",{}),e("br",{}),t("span",{className:"body-min white",children:[e("em",{className:"body-min white",children:"Wanna Pee In Paris"})," utilise les donn\xE9es fournies par la d\xE9marche ",e("a",{className:"white",href:"https://opendata.paris.fr/pages/home/",target:"_blank",children:"Open Data"})," de la Ville de Paris."]})]})]})}function Z(){const[r,s]=l.exports.useState(!0);return t(f,{children:[t("div",{className:"icon-menu open",onClick:()=>{s(!r)},children:[e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"})]}),!r&&e(K,{})]})}function Q(r){const[s,i]=l.exports.useState({longitude:r.coordinates.longitude,latitude:r.coordinates.latitude}),[n,a]=l.exports.useState({longitude:s.longitude,latitude:s.latitude,zoom:13.5}),c=l.exports.useRef(null),[d,m]=l.exports.useState("500"),o=h=>{m(h.target.value)},[u,b]=l.exports.useState([]);l.exports.useEffect(async()=>{try{const h=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=1000&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe&geofilter.distance="+s.latitude+"%2C"+s.longitude+"%2C"+d)).json();b(h.records),c.current.trigger()}catch(h){console.error(h)}},[d]);const v={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[s.longitude,s.latitude]}}]},N={id:"point",type:"circle",paint:{"circle-radius":5,"circle-color":"#007cbf"}},[g,y]=l.exports.useState(null);return t("div",{className:"geoDataResults",children:[e(_,{}),t(q,P(x({},n),{onMove:h=>a(h.viewState),mapStyle:"mapbox://styles/mapbox/streets-v11",mapboxAccessToken:"pk.eyJ1IjoibWFyYy1yYW1vcyIsImEiOiJja3o5d29tOWEwMHNtMnJwZ2huaWl0aTU4In0.9dpBkYt3Vcl2ylw79DTGqw",style:{height:"100%"},children:[e(W,{id:"my-data",type:"geojson",data:v,children:e(F,x({},N))}),e(H,{ref:c}),u.map(h=>e($,{latitude:h.geometry.coordinates[1],longitude:h.geometry.coordinates[0],children:e("button",{className:h===g?"marker marker-clicked":"marker",onClick:k=>{y(h),k.currentTarget.classList.toggle("marker-clicked")}})},h.recordid))]})),t("div",{className:"layer-card-infos",children:[t("label",{htmlFor:"range-selector",className:"body-min range-label",children:[e("span",{className:"sub",children:u.length})," Toilettes publiques"," ",e("br",{})," dans un rayon de ",d," m\xE8tres"]}),e("br",{}),e("input",{id:"range-selector",type:"range",min:"100",max:"5000",value:d,step:"100",onChange:o})]}),e("div",{className:g?"selected-toilet-card":null,children:g&&e(f,{children:e(C,{data:g})})})]})}var X="/assets/logo.461c5b3a.svg",ee="/assets/Illustration.f3763dec.svg";function se(){const[r,s]=l.exports.useState(null),i=u=>{s(u)},n=()=>{s(null),c({latitude:null,longitude:null})},[a,c]=l.exports.useState({latitude:null,longitude:null}),d=u=>{c(u)},[m,o]=l.exports.useState(window.innerWidth);return e(f,{children:m>500?e("div",{className:"mobile-check",children:e("h1",{className:"body",children:"Ce site Internet est accessible uniquement sur mobile"})}):t("div",{className:"App",children:[e("img",{src:X,className:"logo",alt:"Wanna Pee in Paris Logo",onClick:n}),e("img",{src:ee,className:"illustration",alt:"Home page illustration"}),e(Z,{}),r===null&&a.latitude===null&&e(J,{getArr:i,getGeolocate:d}),r&&e(U,{data:r,reset:n,geoData:a}),a.latitude&&e(Q,{coordinates:a})]})})}B.render(e(V.StrictMode,{children:e(se,{})}),document.getElementById("root"));
