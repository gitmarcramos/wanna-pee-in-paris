var _=Object.defineProperty,C=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var k=(r,s,i)=>s in r?_(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,y=(r,s)=>{for(var i in s||(s={}))L.call(s,i)&&k(r,i,s[i]);if(E)for(var i of E(s))T.call(s,i)&&k(r,i,s[i]);return r},S=(r,s)=>C(r,O(s));import{j as x,r as l,v as j,M as q,S as D,L as G,G as W,a as F,R as H,b as $}from"./vendor.e409fc1c.js";const B=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}};B();const e=x.exports.jsx,t=x.exports.jsxs,p=x.exports.Fragment;function V(r){return e("span",{className:"error-message body-min",children:r.msg})}function z(r){const[s,i]=l.exports.useState(""),n=N=>{i(N.currentTarget.value)},[a,o]=l.exports.useState(null),d=["75001","75002","75003","75004","75005","75006","75007","75008","75009","75010","75011","75012","75013","75014","75015","75016","75017","75018","75019","75020"],m=()=>{d.includes(s)&&(o(s),i(""))},[c,u]=l.exports.useState({latitude:null,longitude:null});l.exports.useEffect(()=>{r.getArr(a),r.getGeolocate(c)},[a,c]);const[f,b]=l.exports.useState(!1),v=()=>{(isNaN(s)||s.length!==5||!d.includes(s))&&b(!0)};return t("div",{className:"main-search container",children:[e("h1",{className:"body",children:"Dans quel arrondissement de Paris cherchez-vous des toilettes publiques?"}),t("div",{className:"search-options",children:[t("div",{className:"search-bar",children:[e("input",{type:"text",pattern:"[0-9]*",className:"search-input",onInput:n,value:s}),e("button",{className:"button button--search",onClick:()=>{m(),v(),i("")},children:"Go !"})]}),f&&e(V,{msg:"Veuillez entrer un arrondissement de Paris entre 75001 et 75020"})]})]})}var J="/assets/Close.9d59c4e7.svg";var w="/assets/clock.64606870.svg",I="/assets/wheel.3d4ab1d9.svg",A="/assets/baby.9224b752.svg";function R(r){const s=r.data,i=r.data.fields.horaire||"non sp\xE9cifi\xE9",[n,a]=l.exports.useState({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()});l.exports.useEffect(()=>{a({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()})},[s]),console.log(n);let d=(()=>{let m=[];if(n.closing-n.opening>0)for(let c=n.opening;c<=n.closing;c++)m.push(c);if(n.closing-n.opening==0)for(let c=0;c<=24;c++)m.push(c);if(n.closing-n.opening<0){for(let c=n.opening;c<=24;c++)m.push(c);for(let c=0;c<=n.closing;c++)m.push(c)}if(!isNaN(n.opening)){if(m.includes(n.userHour))return!0;if(!m.includes(n.userHour))return!1}})();return t("div",{className:"item-result",children:[t("div",{className:"item-head",children:[t("h2",{className:"body-min",children:["Type : ",s.fields.type]}),t("h4",{className:"title",children:[s.fields.adresse," - ",s.fields.arrondissement]}),t("div",{className:"item-openState",children:[e("div",{className:d===!0?"state-indicator open":d===!1?"state-indicator closed":"state-indicator maybe"}),e("p",{className:"sub",children:d===!0?"Ouvertes en ce moment":d===!1?"Ferm\xE9es en ce moment":"Horaires d'ouvertures indisponibles."})]})]}),t("div",{className:"item-result-infos",children:[s.fields.horaire==="Voir fiche \xE9quipement"?t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires"}),e("a",{href:s.fields.url_fiche_equipement,className:"body-min",target:"_blank",children:"Voir les horaires"})]}):e(p,{children:s.fields.horaire?t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires"}),e("h5",{className:"body-min",children:s.fields.horaire})]}):t("div",{className:"item-result-infos--item",children:[e("img",{src:w,alt:"Icone des horaires",className:"disabled"}),e("h5",{className:"body-min",children:"Non sp\xE9cifi\xE9"})]})}),s.fields.acces_pmr==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:I,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:I,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}),s.fields.relais_bebe&&s.fields.relais_bebe==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:A,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:A,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]})]})]})}function P(r){const[s,i]=l.exports.useState(!0);return l.exports.useEffect(()=>{const n=setTimeout(()=>{i(!1)},800);return()=>{clearTimeout(n)}},[]),e(p,{children:s&&t("div",{className:"loader",children:[e("h1",{className:"body white",children:"Recherche en cours"}),t("svg",{width:"58",height:"58",viewBox:"0 0 58 58",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("circle",{id:"loader-out",cx:"29",cy:"29",r:"28",stroke:"white",strokeWidth:"2",strokeDasharray:"170"}),e("circle",{id:"loader-middle",cx:"29",cy:"29",r:"21",stroke:"white",strokeWidth:"2",strokeDasharray:"150"}),e("circle",{id:"loader-in",cx:"29",cy:"29",r:"13",stroke:"white",strokeWidth:"2",strokeDasharray:"50"})]})]})})}function Y(r){const[s,i]=l.exports.useState([]);l.exports.useState({longitude:"",latitude:""});//! Here trying to manage the geolocation, but not working with only the button because it needs to have a REAL arrondissement to avoid empty array in results
l.exports.useState("");const[n,a]=l.exports.useState(""),o=u=>{u.currentTarget.checked?a("&refine.acces_pmr=Oui"):a("")},[d,m]=l.exports.useState(""),c=u=>{u.currentTarget.checked?m("&refine.relais_bebe=Oui"):m("")};return l.exports.useEffect(async()=>{try{const u=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=100&q=&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe&refine.arrondissement="+r.data+n+d+"")).json();i(u.records)}catch(u){console.error(u)}},[n,d]),t(p,{children:[e(P,{}),t("div",{className:"search-results container",children:[t("div",{className:"search-results__data",children:[e("img",{src:J,alt:"Close button",className:"close-svg",onClick:r.reset}),t("div",{className:"search-results__data--main",children:[t("h1",{className:"title",children:["Toilettes publiques dans le ",r.data]}),t("h2",{children:[s.length," r\xE9sultats"]})]}),t("div",{className:"search-results__data--filter",children:[e("h3",{className:"sub",children:"Filtrer"}),t("div",{className:"filter-input",children:[t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"acces-pmr",className:"body-min",children:"Acc\xE8s PMR"}),e("input",{type:"checkbox",id:"acces-pmr",onChange:o})]}),t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"relais-bebe",className:"body-min",children:"Relais b\xE9b\xE9"}),e("input",{type:"checkbox",id:"relais-bebe",onChange:c})]})]})]}),e("button",{className:"button-link body",onClick:r.reset,children:"Nouvelle recherche"})]}),s.length===0?e("p",{className:"body",children:"Aucun r\xE9sultat"}):e("div",{className:"toilet",children:s.map(u=>e(R,{data:u},j()))})]})]})}function U(){return t("div",{className:"page-menu",children:[t("div",{className:"about",children:[e("h2",{className:"title white",children:"\xC0 Propos"}),e("p",{className:"body white",children:"Wanna Pee in Paris a pour objectif de vous aider \xE0 trouver rapidement des toilettes publiques dans l\u2019arrondissement Parisien que vous renseignez."})]}),t("div",{className:"credits",children:[e("h3",{className:"body white",children:"Cr\xE9dits"}),t("span",{className:"body-min white",children:["Design et d\xE9veloppement web :"," ",e("a",{className:"white",href:"https://www.marcramos.fr/",target:"_blank",children:"Marc Ramos"})," "]}),e("br",{}),t("span",{className:"body-min white",children:["Image d'illustration :"," ",e("a",{className:"white",href:"https://www.pablostanley.com/",target:"_blank",children:"Pablo Stanley"})," "]}),e("br",{}),e("br",{}),t("span",{className:"body-min white",children:[e("em",{className:"body-min white",children:"Wanna Pee In Paris"})," utilise les donn\xE9es fournies par la d\xE9marche ",e("a",{className:"white",href:"https://opendata.paris.fr/pages/home/",target:"_blank",children:"Open Data"})," de la Ville de Paris."]})]})]})}function K(){const[r,s]=l.exports.useState(!0);return t(p,{children:[t("div",{className:"icon-menu open",onClick:()=>{s(!r)},children:[e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"})]}),!r&&e(U,{})]})}function Z(r){const[s,i]=l.exports.useState({longitude:r.coordinates.longitude,latitude:r.coordinates.latitude}),[n,a]=l.exports.useState({longitude:s.longitude,latitude:s.latitude,zoom:13.5}),o=l.exports.useRef(null),[d,m]=l.exports.useState("500"),c=h=>{m(h.target.value)},[u,f]=l.exports.useState([]);l.exports.useEffect(async()=>{try{const h=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=1000&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe&geofilter.distance="+s.latitude+"%2C"+s.longitude+"%2C"+d)).json();f(h.records),o.current.trigger()}catch(h){console.error(h)}},[d]);const b={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[s.longitude,s.latitude]}}]},v={id:"point",type:"circle",paint:{"circle-radius":5,"circle-color":"#007cbf"}},[g,N]=l.exports.useState(null);return t("div",{className:"geoDataResults",children:[e(P,{}),t(q,S(y({},n),{onMove:h=>a(h.viewState),mapStyle:"mapbox://styles/mapbox/streets-v11",mapboxAccessToken:"pk.eyJ1IjoibWFyYy1yYW1vcyIsImEiOiJja3o5d29tOWEwMHNtMnJwZ2huaWl0aTU4In0.9dpBkYt3Vcl2ylw79DTGqw",style:{height:"100%"},children:[e(D,{id:"my-data",type:"geojson",data:b,children:e(G,y({},v))}),e(W,{ref:o}),u.map(h=>e(F,{latitude:h.geometry.coordinates[1],longitude:h.geometry.coordinates[0],children:e("button",{className:h===g?"marker marker-clicked":"marker",onClick:M=>{N(h),M.currentTarget.classList.toggle("marker-clicked")}})},h.recordid))]})),t("div",{className:"layer-card-infos",children:[t("label",{htmlFor:"range-selector",className:"body-min range-label",children:[e("span",{className:"sub",children:u.length})," Toilettes publiques"," ",e("br",{})," dans un rayon de ",d," m\xE8tres"]}),e("br",{}),e("input",{id:"range-selector",type:"range",min:"100",max:"5000",value:d,step:"100",onChange:c})]}),e("div",{className:g?"selected-toilet-card":null,children:g&&e(p,{children:e(R,{data:g})})})]})}var Q="/assets/logo.461c5b3a.svg",X="/assets/Illustration.f3763dec.svg";function ee(){const[r,s]=l.exports.useState(null),i=u=>{s(u)},n=()=>{s(null),o({latitude:null,longitude:null})},[a,o]=l.exports.useState({latitude:null,longitude:null}),d=u=>{o(u)},[m,c]=l.exports.useState(window.innerWidth);return e(p,{children:m>500?e("div",{className:"mobile-check",children:e("h1",{className:"body",children:"Ce site Internet est accessible uniquement sur mobile"})}):t("div",{className:"App",children:[e("img",{src:Q,className:"logo",alt:"Wanna Pee in Paris Logo",onClick:n}),e("img",{src:X,className:"illustration",alt:"Home page illustration"}),e(K,{}),r===null&&a.latitude===null&&e(z,{getArr:i,getGeolocate:d}),r&&e(Y,{data:r,reset:n,geoData:a}),a.latitude&&e(Z,{coordinates:a})]})})}H.render(e($.StrictMode,{children:e(ee,{})}),document.getElementById("root"));
