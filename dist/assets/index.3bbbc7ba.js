var F=Object.defineProperty,j=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var A=(r,s,i)=>s in r?F(r,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[s]=i,k=(r,s)=>{for(var i in s||(s={}))W.call(s,i)&&A(r,i,s[i]);if(P)for(var i of P(s))H.call(s,i)&&A(r,i,s[i]);return r},C=(r,s)=>j(r,q(s));import{j as w,r as l,v as B,M as $,S as V,L as z,G as J,a as Y,R as U,b as K}from"./vendor.e409fc1c.js";const Z=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}};Z();const e=w.exports.jsx,t=w.exports.jsxs,b=w.exports.Fragment;function M(r){return e("span",{className:"error-message body-min",children:r.msg})}function Q(r){const[s,i]=l.exports.useState(""),n=p=>{i(p.currentTarget.value)},[a,o]=l.exports.useState(null),d=["75001","75002","75003","75004","75005","75006","75007","75008","75009","75010","75011","75012","75013","75014","75015","75016","75017","75018","75019","75020"],h=()=>{d.includes(s)&&(o(s),i(""))},[c,u]=l.exports.useState({latitude:null,longitude:null}),[x,g]=l.exports.useState(!1),f=async()=>{navigator.geolocation.getCurrentPosition(function(p){u({latitude:p.coords.latitude,longitude:p.coords.longitude})},function(p){p.code==p.PERMISSION_DENIED&&g(!0)})};l.exports.useEffect(()=>{r.getArr(a),r.getGeolocate(c)},[a,c]);const[E,N]=l.exports.useState(!1),v=()=>{(isNaN(s)||s.length!==5||!d.includes(s))&&N(!0)};return t("div",{className:"main-search container",children:[e("h1",{className:"body",children:"Dans quel arrondissement de Paris cherchez-vous des toilettes publiques?"}),t("div",{className:"search-options",children:[t("div",{className:"search-bar",children:[e("input",{type:"text",pattern:"[0-9]*",className:"search-input",onInput:n,value:s}),e("button",{className:"button button--search",onClick:()=>{h(),v(),i("")},children:"Go !"})]}),E&&e(M,{msg:"Veuillez entrer un arrondissement de Paris entre 75001 et 75020"}),e("span",{className:"body-min",children:"ou"}),e("button",{className:"button button--main",onClick:f,children:"G\xE9olocalisez-moi !"}),x?e(M,{msg:"La geolocalisation n'est pas activ\xE9e sur votre navigateur"}):null]})]})}var X="/assets/Close.9d59c4e7.svg";var S="/assets/clock.64606870.svg",_="/assets/wheel.3d4ab1d9.svg",O="/assets/baby.9224b752.svg";function G(r){const s=r.data,i=r.data.fields.horaire||"non sp\xE9cifi\xE9",[n,a]=l.exports.useState({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()});l.exports.useEffect(()=>{a({opening:Number(i.split(" ")[0]),closing:Number(i.split(" ")[3]),userHour:new Date().getHours()})},[s]);let d=(()=>{let h=[];if(n.closing-n.opening>0)for(let c=n.opening;c<=n.closing;c++)h.push(c);if(n.closing-n.opening==0)for(let c=0;c<=24;c++)h.push(c);if(n.closing-n.opening<0){for(let c=n.opening;c<=24;c++)h.push(c);for(let c=0;c<=n.closing;c++)h.push(c)}if(!isNaN(n.opening)){if(h.includes(n.userHour))return!0;if(!h.includes(n.userHour))return!1}})();return t("div",{className:"item-result",children:[t("div",{className:"item-head",children:[t("h2",{className:"body-min",children:["Type : ",s.fields.type]}),t("h4",{className:"title",children:[s.fields.adresse," - ",s.fields.arrondissement]}),t("div",{className:"item-openState",children:[e("div",{className:d===!0?"state-indicator open":d===!1?"state-indicator closed":"state-indicator maybe"}),e("p",{className:"sub",children:d===!0?"Ouvertes en ce moment":d===!1?"Ferm\xE9es en ce moment":"Horaires d'ouvertures indisponibles."})]})]}),t("div",{className:"item-result-infos",children:[s.fields.horaire==="Voir fiche \xE9quipement"?t("div",{className:"item-result-infos--item",children:[e("img",{src:S,alt:"Icone des horaires"}),e("a",{href:s.fields.url_fiche_equipement,className:"body-min",target:"_blank",children:"Voir les horaires"})]}):e(b,{children:s.fields.horaire?t("div",{className:"item-result-infos--item",children:[e("img",{src:S,alt:"Icone des horaires"}),e("h5",{className:"body-min",children:s.fields.horaire})]}):t("div",{className:"item-result-infos--item",children:[e("img",{src:S,alt:"Icone des horaires",className:"disabled"}),e("h5",{className:"body-min",children:"Non sp\xE9cifi\xE9"})]})}),s.fields.acces_pmr==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:_,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:_,alt:"Icon d'acc\xE8s PMR"}),e("h5",{className:"body-min",children:"Acc\xE8s PMR"})]}),s.fields.relais_bebe&&s.fields.relais_bebe==="Oui"?t("div",{className:"item-result-infos--item",children:[e("img",{src:O,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]}):t("div",{className:"item-result-infos--item disabled",children:[e("img",{src:O,alt:"Icon de relais b\xE9b\xE9"}),e("h5",{className:"body-min",children:"Relais b\xE9b\xE9"})]})]})]})}function L(r){const[s,i]=l.exports.useState(!0);return l.exports.useEffect(()=>{const n=setTimeout(()=>{i(!1)},800);return()=>{clearTimeout(n)}},[]),e(b,{children:s&&t("div",{className:"loader",children:[e("h1",{className:"body white",children:"Recherche en cours"}),t("svg",{width:"58",height:"58",viewBox:"0 0 58 58",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("circle",{id:"loader-out",cx:"29",cy:"29",r:"28",stroke:"white",strokeWidth:"2",strokeDasharray:"170"}),e("circle",{id:"loader-middle",cx:"29",cy:"29",r:"21",stroke:"white",strokeWidth:"2",strokeDasharray:"150"}),e("circle",{id:"loader-in",cx:"29",cy:"29",r:"13",stroke:"white",strokeWidth:"2",strokeDasharray:"50"})]})]})})}function ee(r){const[s,i]=l.exports.useState([]);l.exports.useState({longitude:"",latitude:""});const[n,a]=l.exports.useState(""),o=u=>{u.currentTarget.checked?a("&refine.acces_pmr=Oui"):a("")},[d,h]=l.exports.useState(""),c=u=>{u.currentTarget.checked?h("&refine.relais_bebe=Oui"):h("")};return l.exports.useEffect(async()=>{try{const u=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=100&q=&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe&refine.arrondissement="+r.data+n+d+"")).json();i(u.records)}catch(u){console.error(u)}},[n,d]),t(b,{children:[e(L,{}),t("div",{className:"search-results container",children:[t("div",{className:"search-results__data",children:[e("img",{src:X,alt:"Close button",className:"close-svg",onClick:r.reset}),t("div",{className:"search-results__data--main",children:[t("h1",{className:"title",children:["Toilettes publiques dans le ",r.data]}),t("h2",{children:[s.length," r\xE9sultats"]})]}),t("div",{className:"search-results__data--filter",children:[e("h3",{className:"sub",children:"Filtrer"}),t("div",{className:"filter-input",children:[t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"acces-pmr",className:"body-min",children:"Acc\xE8s PMR"}),e("input",{type:"checkbox",id:"acces-pmr",onChange:o})]}),t("div",{className:"filter-input--item",children:[e("label",{htmlFor:"relais-bebe",className:"body-min",children:"Relais b\xE9b\xE9"}),e("input",{type:"checkbox",id:"relais-bebe",onChange:c})]})]})]}),e("button",{className:"button-link body",onClick:r.reset,children:"Nouvelle recherche"})]}),s.length===0?e("p",{className:"body",children:"Aucun r\xE9sultat"}):e("div",{className:"toilet",children:s.map(u=>e(G,{data:u},B()))})]})]})}function se(){return t("div",{className:"page-menu",children:[t("div",{className:"about",children:[e("h2",{className:"title white",children:"\xC0 Propos"}),e("p",{className:"body white",children:"Wanna Pee in Paris a pour objectif de vous aider \xE0 trouver rapidement des toilettes publiques dans l\u2019arrondissement Parisien que vous renseignez."})]}),t("div",{className:"credits",children:[e("h3",{className:"body white",children:"Cr\xE9dits"}),t("span",{className:"body-min white",children:["Design et d\xE9veloppement web :"," ",e("a",{className:"white",href:"https://www.marcramos.fr/",target:"_blank",children:"Marc Ramos"})," "]}),e("br",{}),t("span",{className:"body-min white",children:["Image d'illustration :"," ",e("a",{className:"white",href:"https://www.pablostanley.com/",target:"_blank",children:"Pablo Stanley"})," "]}),e("br",{}),e("br",{}),t("span",{className:"body-min white",children:[e("em",{className:"body-min white",children:"Wanna Pee In Paris"})," utilise les donn\xE9es fournies par la d\xE9marche ",e("a",{className:"white",href:"https://opendata.paris.fr/pages/home/",target:"_blank",children:"Open Data"})," de la Ville de Paris."]})]})]})}function te(){const[r,s]=l.exports.useState(!0);return t(b,{children:[t("div",{className:"icon-menu open",onClick:()=>{s(!r)},children:[e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"}),e("div",{className:r?"burger-line":"burger-line burger-closed"})]}),!r&&e(se,{})]})}function re(r){const[s,i]=l.exports.useState({longitude:r.coordinates.longitude,latitude:r.coordinates.latitude}),[n,a]=l.exports.useState({longitude:s.longitude,latitude:s.latitude,zoom:13.5}),o=l.exports.useRef(null),[d,h]=l.exports.useState("500"),c=m=>{h(m.target.value)},[u,x]=l.exports.useState([]),[g,f]=l.exports.useState(""),E=m=>{m.currentTarget.checked?f("&refine.acces_pmr=Oui"):f("")},[N,v]=l.exports.useState(""),I=m=>{m.currentTarget.checked?v("&refine.relais_bebe=Oui"):v("")};l.exports.useEffect(async()=>{try{const m=await(await fetch("https://opendata.paris.fr/api/records/1.0/search/?dataset=sanisettesparis&q=&rows=1000&facet=type&facet=statut&facet=arrondissement&facet=horaire&facet=acces_pmr&facet=relais_bebe"+g+N+"&geofilter.distance="+s.latitude+"%2C"+s.longitude+"%2C"+d)).json();x(m.records),await o.current.trigger()}catch(m){console.error(m)}},[d,N,g]);const p={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[s.longitude,s.latitude]}}]},T={id:"point",type:"circle",paint:{"circle-radius":5,"circle-color":"#007cbf"}},[y,R]=l.exports.useState(null);return t(b,{children:[e(L,{}),t("div",{className:"geoDataResults",children:[t($,C(k({},n),{onMove:m=>a(m.viewState),mapStyle:"mapbox://styles/mapbox/streets-v11",mapboxAccessToken:"pk.eyJ1IjoibWFyYy1yYW1vcyIsImEiOiJja3o5d29tOWEwMHNtMnJwZ2huaWl0aTU4In0.9dpBkYt3Vcl2ylw79DTGqw",style:{height:"100%"},children:[e(V,{id:"my-data",type:"geojson",data:p,children:e(z,k({},T))}),e(J,{ref:o}),u.map(m=>e(Y,{latitude:m.geometry.coordinates[1],longitude:m.geometry.coordinates[0],children:e("button",{className:m===y?"marker marker-clicked":"marker",onClick:D=>{R(m),D.currentTarget.classList.toggle("marker-clicked")}})},m.recordid))]})),e("div",{className:"pill"}),t("div",{className:"layer-card-infos",draggable:"true",children:[t("label",{htmlFor:"range-selector",className:"body-min range-label",children:[e("span",{className:"sub",children:u.length})," Toilettes publiques"," ",e("br",{})," dans un rayon de ",d," m\xE8tres"]}),e("br",{}),e("input",{id:"range-selector",type:"range",min:"100",max:"5000",value:d,step:"100",onChange:c}),t("div",{className:"checkbox-container",children:[e("h3",{className:"sub",children:"Filtrer"}),t("div",{className:"checkbox-container-filter",children:[t("div",{className:"checkbox-container-filter--item",children:[e("label",{htmlFor:"acces-pmr",className:"body-min",children:"Acc\xE8s PMR"}),e("input",{type:"checkbox",id:"acces-pmr",onClick:E})]}),t("div",{className:"checkbox-container-filter--item",children:[e("label",{htmlFor:"relais-bebe",className:"body-min",children:"Relais b\xE9b\xE9"}),e("input",{type:"checkbox",id:"relais-bebe",onClick:I})]})]})]})]}),e("div",{className:y?"selected-toilet-card":null,children:y&&t(b,{children:[e("button",{className:"close-selected-toilets",onClick:()=>{R(null)},children:"Close"}),e(G,{data:y})]})})]})]})}var ae="/assets/logo.461c5b3a.svg",ie="/assets/Illustration.f3763dec.svg";function ne(){const[r,s]=l.exports.useState(null),i=u=>{s(u)},n=()=>{s(null),o({latitude:null,longitude:null})},[a,o]=l.exports.useState({latitude:null,longitude:null}),d=u=>{o(u)},[h,c]=l.exports.useState(window.innerWidth);return e(b,{children:h>500?e("div",{className:"mobile-check",children:e("h1",{className:"body",children:"Ce site Internet est accessible uniquement sur mobile"})}):t("div",{className:"App",children:[e("img",{src:ae,className:"logo",alt:"Wanna Pee in Paris Logo",onClick:n}),e("img",{src:ie,className:"illustration",alt:"Home page illustration"}),e(te,{}),r===null&&a.latitude===null&&e(Q,{getArr:i,getGeolocate:d}),r&&e(ee,{data:r,reset:n,geoData:a}),a.latitude&&e(re,{coordinates:a})]})})}U.render(e(K.StrictMode,{children:e(ne,{})}),document.getElementById("root"));
